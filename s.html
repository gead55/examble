<html>
<body>
<script type="text/javascript">
	var number = [1, 2, 3, 4, 5, 6, 7, 8, 9];
	var cube = [
				[0, 0, 0, 0, 0, 0, 0, 0, 0],
				[0, 0, 0, 0, 0, 0, 0, 0, 0],
				[0, 0, 0, 0, 0, 0, 0, 0, 0],
				[0, 0, 0, 0, 0, 0, 0, 0, 0],
				[0, 0, 0, 0, 0, 0, 0, 0, 0],
				[0, 0, 0, 0, 0, 0, 0, 0, 0],
				[0, 0, 0, 0, 0, 0, 0, 0, 0],
				[0, 0, 0, 0, 0, 0, 0, 0, 0],
				[0, 0, 0, 0, 0, 0, 0, 0, 0],
			   ];
	var sdk = [
				[1, 2, 3, 4, 5, 6, 7, 8, 9],
				[1, 2, 3, 4, 5, 6, 7, 8, 9],
				[1, 2, 3, 4, 5, 6, 7, 8, 9],
				[1, 2, 3, 4, 5, 6, 7, 8, 9],
				[1, 2, 3, 4, 5, 6, 7, 8, 9],
				[1, 2, 3, 4, 5, 6, 7, 8, 9],
				[1, 2, 3, 4, 5, 6, 7, 8, 9],
				[1, 2, 3, 4, 5, 6, 7, 8, 9],
				[1, 2, 3, 4, 5, 6, 7, 8, 9],
			   ];
	function sudoku(){
		console.log(sdk);
		var isConflict = true;
		var row = [0, 3, 6];//[0, 1, 2, 3, 4, 5, 6, 7, 8];//
		var i = 0;
		while(row.length > 0){
			isConflict = true;
			var irow = Math.floor(Math.random()*row.length);
			var col = [0, 1, 2, 3, 4, 5, 6, 7, 8];
			while(col.length > 0){
				var icol = Math.floor(Math.random()*col.length);
				var vrow = row[irow];
				var vcol = col[icol];
				// var run = (row*9)+col;
				var run = (vrow*9)+vcol;

          		var ibox = checkIbox(run,vrow,vcol);
          		var pbox = checkPbox(run,vrow,vcol);
          		// console.log(run+":"+vrow+":"+vcol+":"+ibox+":"+pbox+":"+col)
          		var xy = getXYtoArray(ibox,pbox);
          		var remain = sdk[vrow].diff(xy);
          		var the_one = remain[Math.floor(Math.random()*remain.length)];
		console.log("["+ibox+"]["+pbox+"]"+the_one+"::"+remain);
		// console.log(sdk[vrow]+":diff:"+xy);
		// console.log(ibox+":"+pbox+":"+xy+"|"+sdk[vrow]+"::"+remain);
				if(remain.length){
	          		cube[ibox][pbox] = the_one;
	     			sdk[vrow].splice(sdk[vrow].indexOf(the_one),1);
	     			col.splice(icol,1);
				}else{
		console.log("///////////////////");

					isConflict = false;
					break;
				}

			}
		console.log("**********************");
			
			// if(isConflict) 
				row.splice(irow,1);
		}
		// console.log(sdk);
		return cube;
	}

	function getXYtoArray(r,c){
		var arr = [];
		var i = 0;
		// console.log(r+":"+c);
		while(i < 9){
			if(cube[i][c] > 0){
				arr[arr.length] = cube[i][c];
			}
			i++;
		}
		// console.log(arr+"/"+cube[r]);
		//console.log(arr.concat(cube[r]));
		return arr.concat(cube[r]);
	}

	function randomInArray(items){
		return item = items[Math.floor(Math.random()*items.length)];
	}

	function checkPbox(cunt,r,c){
		var column = Math.floor((cunt%3));
		var line = Math.floor(r%3);
		return column+(line*3);
	}

	function checkIbox(cunt,r,c){
		var column = Math.floor((cunt/3)%3);
		var line = Math.floor(r/3);
		return column+(line*3);
	}

	Array.prototype.diff = function(a) {
	    return this.filter(function(i) {return a.indexOf(i) < 0;});
	};

console.log(sudoku());	
// var v = [1, 2, 3, 4, 5, 6, 7, 8, 9];
// var a = [3,4,5,0];
// var b = [6,7,8];
// var c = a.concat(b);
// console.log(v.diff(c));	

</script>

</body>
</html>